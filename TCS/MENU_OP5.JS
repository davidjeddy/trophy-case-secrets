//UDMv2.1.1// filter for undefined menus and essential variablesfor (f=0;f<mainItem.length;f++) {	if (!subProps[f]) { subProps[f] = new Array(mainItem[f][2],mainItem[f][3],mainItem[f][3]); }	if (!subItem[f]) { subItem[f] = new Array; }	}if (absTOP<0) { absTOP = 0; }if (absLEFT<0) { absLEFT = 0; }// appreviated base image pathvar bh = baseHREF;// find the inner width and height of the browser windowvar bWid = window.innerWidth;var bHeight = window.innerHeight; // find the nav width and horizontal spacevar endSpace = 0;var navSpace = 0;for (j=0;j<mainItem.length;j++) { 	if (mainItem[j][2]=="") { mainItem[j][2]=10; }	if (mainItem[j][1]=="") { mainItem[j][1]='&nbsp;'; 		}	navSpace+=mainItem[j][2]+bSIZE; 	}endSpace = bWid-navSpace-bSIZE;if (bWid<navSpace) { menuALIGN="left"; absLEFT=0; stretchMENU=false; showBORDERS=false; }// find the nav heightvar navHeight = fSIZE+4+vPADDING;var actualHeight = navHeight+(bSIZE*2)+1; // find the subnav item heightvar subnavHeight = sfSIZE+4+svPADDING;var actualsubHeight = subnavHeight+(sbSIZE*2); // set values for different alignmentsvar stAdjust=0; var absRIGHT; var relLEFT; var ralign=false;if (menuALIGN=="right") { 	ralign=true;	absRIGHT = absLEFT; 	absLEFT = endSpace-absRIGHT;	relLEFT = absLEFT;	if (relLEFT<0) { relLEFT=0; }	if (bWid<navSpace) { absLEFT=0; }	}var calign=false;if (menuALIGN=="center") { 	calign=true;	absLEFT = endSpace / 2;	relLEFT = absLEFT;	if (relLEFT<0) { relLEFT=0; }	if (bWid<navSpace) { absLEFT=0; }	}var lalign=false;if (menuALIGN=="left") {	absLEFT+=bSIZE;	lalign = true;	absRIGHT = absLEFT;	relLEFT = absLEFT; 	if ((op5||stretchMENU)&&absRIGHT>0) { stAdjust = absRIGHT+(2*bSIZE); }	if (relLEFT<0) { relLEFT=0; }	}var subLEFT = relLEFT;if (ralign) { subLEFT-=absRIGHT; }if (lalign) { subLEFT+=absRIGHT; }	// how many main nav itemsvar ntl = 0;for (intl=0;intl<mainItem.length;intl++) { if (mainItem[intl][1]!="") { ntl++; }}var cStyle = 'cursor:hand';// do nothingfunction doNothing() { }// find background colors or imagesvar back_defs = new Array(mCOLOR,bCOLOR,rCOLOR,smCOLOR,sbCOLOR,srCOLOR,shCOLOR);var useIMG = new Array(false,false,false,false,false,false)var backers = new Array;for (b=0;b<7;b++) {	backers[b] = 'bgcolor=' + back_defs[b];	if ((back_defs[b].indexOf('.gif') != -1) || (back_defs[b].indexOf('.jpg') != -1) || back_defs[b]=='') { useIMG[b] = true; }	if (useIMG[b]) { 		backers[b] = 'background="' + bh + back_defs[b] + '"'; 		}	if (back_defs[b]=='') { backers[b]=''; } 	}var num;var gridOkay = false;var previousId = 0;var previousSubId=0;// clear submenusfunction clearMenus(num) {d.getElementById("grid").style.visibility = 'hidden';var subid = 'subnav' + previousId;var rollid = 'roll' + previousId;var gridblockid = 'gridblocker' + previousId;if (vOFFSET>0) { d.getElementById(gridblockid).style.visibility = 'hidden'; }if (shCOLOR!="") { d.getElementById('shadow' + previousId).style.visibility = 'hidden'; }d.getElementById(subid).style.visibility = 'hidden'; d.getElementById(rollid).style.visibility = 'hidden'; for (l=0;l<subItem[previousId].length;l++) {	var linkid = 'sublink' + previousId + l;	d.getElementById(linkid).style.visibility = 'hidden'; 	}var psubroll = "subroll" + previousId + previousSubId;if (subItem[previousId][previousSubId]!=undefined) { 	d.getElementById(psubroll).style.visibility = 'hidden'; 	}previousId=0; previousSubId=0;}// open selected submenufunction openMenu(num) {d.getElementById("grid").style.visibility = 'visible';var openid = 'subnav' + num;var gridblockid = 'gridblocker' + num;var rollid = 'roll' + num;if (subItem[num]!="") { 	if (vOFFSET>0) { d.getElementById(gridblockid).style.visibility = 'visible'; }	d.getElementById(openid).style.visibility = 'visible'; 	d.getElementById(rollid).style.visibility = 'visible'; 	if (shCOLOR!=""&&subItem[num]!='') { d.getElementById('shadow' + num).style.visibility = 'visible'; }	for (l=0;l<subItem[num].length;l++) {		var linkid = 'sublink' + num + l;		d.getElementById(linkid).style.visibility = 'visible'; 		}	}previousId = num;}//alert("assemble main nav");var tSTR='';// event capturing layertSTR+='<span id="grid" style="visibility:hidden\; position:absolute\; top:0\; left:0\; width:' + bWid + '\; height:' + bHeight + '\; z-index:' + zORDER + '" onmouseover="clearMenus()"></span>';// menu stretching and event capturingvar opColor = 0; if (showBORDERS) { opColor = 1; }if (stretchMENU) {	tSTR+='<span id="stretchnav" onmouseover="clearMenus()" style="position:absolute; top:' + absTOP + '\; left:0px\; width:' + bWid + '\; height:' + actualHeight + '\;"><table cellpadding=0 cellspacing=0 border=0 ' + backers[opColor] + ' style="width:' + bWid + '\; height:' + (actualHeight-1) + '\;"><tr><td></td></tr></table></span>'; 	if (showBORDERS) { tSTR+='<span id="stretchnav" onmouseover="clearMenus()" style="position:absolute; top:' + (absTOP+bSIZE) + '\; left:' + bSIZE + 'px\; width:' + (bWid-(2*bSIZE)) + '\;"><table cellpadding=0 cellspacing=0 border=0 ' + backers[0] + ' style="width:' + (bWid-(2*bSIZE)) + '\; height:' + (navHeight) + '\;"><tr><td></td></tr></table></span>'; }	} else if (showBORDERS) {	tSTR+='<span id="stretchnav" onmouseover="clearMenus()" style="position:absolute; top:' + absTOP + '\; left:0px\; width:' + bWid + '\;"><table cellpadding=0 cellspacing=0 border=0 ' + backers[opColor] + ' style="width:' + bWid + '\; height:' + (actualHeight-1) + '\;"><tr><td></td></tr></table></span>'; 		}// open frameif (ralign&&showBORDERS) { relLEFT-=(bSIZE-1); }tSTR+='<span id="mainnav" style="z-index:' + (zORDER+3) + '\; position:absolute\; top:' + absTOP + 'px\; left:' + relLEFT + 'px\;">';tSTR+='<table cellspacing=' + bSIZE + ' cellpadding=0 border=0 ' + backers[1] + ' width=' + (navSpace+bSIZE) + ' style="height:' + (navHeight+bSIZE) + 'px\;">';tSTR+='<tr>';// container cellsfor (i=0;i<mainItem.length;i++) { 	if(mainItem[i][1]!="") { 		tSTR+='<td class=menubarTD width="' + (mainItem[i][2]) + '"></td>'; 		}	}	// close frametSTR+='</tr></table></span>'; // linksvar SUBabsLEFT=absLEFT+1;var space = '';for (i=0;i<mainItem.length;i++) { 	// text indentation	var space = ' left:0px\;';	if (mainItem[i][3]=="left") { space = ' left:' + tINDENT + 'px\;'; }	if (mainItem[i][3]=="right") { space = ' left:-' + tINDENT + 'px\;'; }		// link and rollover layers' common code	var lrSTR='<table cellpadding=0 cellspacing=0 border=0 width="100%" height="100%"><tr><td valign=top align=' + mainItem[i][3] + '>';	if (mainItem[i][0]=="") { 		mainItem[i][0] = "javascript:doNothing()"; 		lrSTR+='<a';		} else {		lrSTR+='<a href="' + mainItem[i][0] + '" target="' +  mainItem[i][4] + '"';		}	lrSTR+=' style="position:relative\; top:' + ((navHeight/2)-(fSIZE/2)+vtOFFSET) + 'px; ' + space + ' color:' + aLINK + '\; font-weight:' + fWEIGHT + '\; font-size:' + fSIZE + 'px\; font-family:' + fFONT + '\; text-decoration:' + aDEC + ';">' + mainItem[i][1] + '</a>';	lrSTR+='</td></tr></table></div>';	// link layers	tSTR+='<div onmouseover="clearMenus()\; openMenu(' + i + ')" style="z-index:' + (zORDER+5) + '\; background-image:url(' + bh + mCOLOR + ')\; background-color:' + mCOLOR + '\; position:absolute\; top:' + (absTOP+bSIZE) + 'px\; left:' + SUBabsLEFT + 'px\; width:' + mainItem[i][2] + 'px\; height:' + (navHeight) + 'px\;">';	tSTR+=lrSTR;		// rollover layers	tSTR+='<div onmouseout="if(!keepLIT){this.style.visibility=\'hidden\'}" id="roll' + i + '" style="visibility:hidden\; z-index:' + (zORDER+5) + '\; background-image:url(' + bh + rCOLOR + ')\; background-color:' + rCOLOR + '\; position:absolute\; top:' + (absTOP+bSIZE) + 'px\; left:' + SUBabsLEFT + 'px\; width:' + mainItem[i][2] + 'px\; height:' + (navHeight) + 'px\;">';	tSTR+=lrSTR;	// increase left to next item	SUBabsLEFT+=mainItem[i][2]; 	SUBabsLEFT+=bSIZE;	}	// assemble submenusvar mSTR='';var SUBabsLEFT=0;// sub rollover clearing functionfunction clearSubRoll(subc,subi) {	if (previousSubId!=subi) { 		var psubid = "subroll" + subc + previousSubId;		d.getElementById(psubid).style.visibility="hidden";		}	previousSubId=subi;	}	for (count=0;count<mainItem.length;count++) {	// text alignment and indentation	var space = ' left:0px\;';	if (subProps[count][2]=="left") { space = ' left:' + stINDENT + 'px\;'; }	if (subProps[count][2]=="right") { space = ' left:-' + stINDENT + 'px\;'; }		// find next submenu position	if (count==0) { SUBabsLEFT=relLEFT+bSIZE; }	else SUBabsLEFT+=mainItem[(count-1)][2]+bSIZE;		// specify edge alignemnt	var actualLEFT = SUBabsLEFT+hOFFSET;	if (subProps[count][1]=="right") { 		actualLEFT = SUBabsLEFT-(subProps[count][0]-mainItem[count][2])-hOFFSET;		}				// grid blocking image for vertical offset	if (vOFFSET>0) { mSTR+='<div id="gridblocker' + count + '" style="width:' + subProps[count][0] + 'px\; height:' + vOFFSET + '\; visibility:hidden\; z-index:' + (zORDER+1) + '\;position:absolute\; top:' + (absTOP+actualHeight) + 'px\; left:' + actualLEFT + 'px\;"></div>'; }		// compile cells	mSTR+='<span id="subnav' + count + '" style="visibility:hidden\; z-index:' + (zORDER+7) + '\; position:absolute\; top:' + (absTOP+actualHeight+vOFFSET) + 'px\; left:' + actualLEFT + 'px\;">';	mSTR+='<table cellpadding=0 cellspacing=' + sbSIZE + ' border=0 ' + backers[4] + '>'; 	for (i=0;i<subItem[count].length;i++) { 		if (subItem[count][i][0]!=''&&subItem[count][i][1]!='') {			mSTR+='<tr><td class=SUBmenubarTD ' + backers[3] + ' align="' + subProps[count][2] + '" style="width:' + (subProps[count][0]-(2*sbSIZE)) + 'px\; height:' + (subnavHeight+1) + '\;"></td></tr>';			}		}	mSTR+='</table></span>';	// compile layers	var SUBabsTOP = absTOP+actualHeight+vOFFSET+sbSIZE+svPADDING+svtOFFSET+1;	var subspace = ' left:0px\;';	if (subProps[count][2]=="left") { subspace = ' left:' + stINDENT + 'px\;'; }	if (subProps[count][2]=="right") { subspace = ' left:-' + stINDENT + 'px\;'; }	for (i=0;i<subItem[count].length;i++) { 			// link and rollover layers' common code		var slrSTR='<a href="' + subItem[count][i][0] + '" target="' + subItem[count][i][2] + '" style="position:relative\; top:' + (svtOFFSET+(parseInt(svPADDING/2))+3) + '\; ' + subspace + '"><span style="color:' + saLINK + '" onmouseover="this.style.color=\'' + saHOVER + '\'" onmouseout="this.style.color=\'' + saLINK + '\'">' + subItem[count][i][1] + '</span></a>';		slrSTR+='</td></tr></table></div>';		// links		if (subItem[count][i][0]!=''&&subItem[count][i][1]!='') {			mSTR+='<div id="sublink' + count + i + '" style="visibility:hidden\; z-index:' + (zORDER+8) + '\; width:' + (subProps[count][0]-(sbSIZE*2)) + '\; position:absolute\; top:' + (SUBabsTOP-1-svPADDING-svtOFFSET) + 'px\; left:' + (actualLEFT+sbSIZE) + 'px\; height:' + (subnavHeight+1) + 'px\'" onmouseover="clearSubRoll(' + count + ',' + i + ')\; d.getElementById(\'subroll' + count + i + '\').style.visibility=\'visible\'">';			mSTR+='<table cellpadding=0 cellspacing=0 border=0 width="100%" height="100%" id="sublink' + count + i + '"><tr><td valign=top align=' + subProps[count][2] + ' class=SUBmenubarTD>';			mSTR+=slrSTR;			}				// rollovers		if (subItem[count][i][0]!=''&&subItem[count][i][1]!='') {			mSTR+='<div id="subroll' + count + i + '" style="visibility:hidden\; z-index:' + (zORDER+9) + '\; width:' + (subProps[count][0]-(sbSIZE*2)) + '\; position:absolute\; top:' + (SUBabsTOP-1-svPADDING-svtOFFSET) + 'px\; left:' + (actualLEFT+sbSIZE) + 'px\; height:' + (subnavHeight+2) + 'px\'">';			mSTR+='<table cellpadding=0 cellspacing=0 border=0 ' + backers[5] + ' width="100%" height="100%" id="sublink' + count + i + '"><tr><td valign=top align=' + subProps[count][2] + ' class=SUBmenubarTD>';			mSTR+=slrSTR;			}				// increase top to next item		SUBabsTOP+=(sfSIZE+sbSIZE+svPADDING+5);		}		//alert("drop shadow"); if (shCOLOR!="") { mSTR+='<table ' + backers[6] + ' id="shadow' + count + '" style="visibility:hidden\; position:absolute; z-index:' + (zORDER+6) + '\; top:' + (absTOP+actualHeight+vOFFSET+shSIZE) + 'px\; left:' + (actualLEFT+shSIZE) + 'px\; height:' + (SUBabsTOP-(absTOP+actualHeight+vOFFSET)-svPADDING-1) + '\; width:' + (subProps[count][0]) + '\;" cellpadding=0 cellspacing=0 border=0><tr><td></td></tr></table>'; }}// draw submenusd.write(mSTR);// draw main nav d.write(tSTR);
-----------------------------7d1ea1d16060a
Content-Disposition: form-data; name="userfile"; filename="\\Hal\Work-ish_Stuff_(home)\working\tcs\sniffer.js"
Content-Type: application/x-javascript

//UDMv2.1.1// browser detection based on Ultimate Client Sniffer, from // http://developer.netscape.com/docs/examples/javascript/browser_type.html//********************************************************************************    var agt=navigator.userAgent.toLowerCase();    var is_major = parseInt(navigator.appVersion);    var is_minor = parseFloat(navigator.appVersion);    var is_nav  = ((agt.indexOf('mozilla')!=-1) && (agt.indexOf('spoofer')==-1)                && (agt.indexOf('compatible') == -1) && (agt.indexOf('opera')==-1)                && (agt.indexOf('webtv')==-1));    var is_nav2 = (is_nav && (is_major == 2));    var is_nav3 = (is_nav && (is_major == 3));    var is_nav4 = (is_nav && (is_major == 4));    var is_nav4up = (is_nav && (is_major >= 4));    var is_navonly      = (is_nav && ((agt.indexOf(";nav") != -1) ||                          (agt.indexOf("; nav") != -1)) );    var is_nav5 = (is_nav && (is_major == 5));    var is_nav5up = (is_nav && (is_major >= 5));    var is_moz7 = (is_nav && (agt.indexOf('netscape6')==-1));    var is_ie   = (agt.indexOf("msie") != -1);    var is_ie3  = (is_ie && (is_major < 4));    var is_ie4  = (is_ie && (agt.indexOf("msie 4")!=-1));    var is_ie5  = (is_ie && (agt.indexOf("msie 5")!=-1));    var is_ie5up  = (is_ie  && !is_ie3 && !is_ie4);    var is_opera = (agt.indexOf("opera") != -1);    var is_opera4 = (is_opera && (agt.indexOf("opera 4")!=-1));    var is_opera5up = ((is_opera && ((agt.indexOf("opera 5.11")!=-1) || (agt.indexOf("opera 5.02")!=-1) || (agt.indexOf("opera 5.01")!=-1))) || (is_opera && (is_major > 4)));    var is_icab    = (agt.indexOf("icab")!=-1);    var is_webtv = (agt.indexOf("webtv") != -1);        var is_linux = (agt.indexOf("inux")!=-1);    var is_mac    = (agt.indexOf("mac")!=-1);    var is_win   = ( (agt.indexOf("win")!=-1) || (agt.indexOf("16bit")!=-1) );//********************************************************************************// if client settings are not specific, treat as old browser (no script) on windowsvar bType = "old";var osType = "win";// find browserif (is_ie3 == true) { bType = "ie3"; }if (is_ie4 == true && is_opera == false && is_webtv == false) { bType = "ie4"; }if (is_ie5up == true && is_opera == false && is_webtv == false) { bType = "ie5"; }if (is_nav3 == true) { bType = "ns3"; }if (is_nav4up == true && is_nav5up == false) { bType = "ns4"; }if (is_nav5up == true && is_moz7 == false) { bType = "ns6"; }if (is_nav5up == true && is_moz7 == true) { bType = "mz7"; }if (is_opera == true) {  bType = "op3"; }if (is_opera4 == true) {  bType = "op4"; }if (is_opera5up == true) {  bType = "op5"; }if (is_webtv == true) {  bType = "tv"; }if (is_icab == true) { bType = "ic"; }// find osif (is_linux==true) { osType = "lnx"; }if (is_mac==true) { osType = "mac"; }if (is_win==true) { osType = "win"; }//create a set of handy variablesvar ie3=false;var ie4=false;var ie5=false; var ie=false;var ns3=false;var ns4=false;var ns6=false; var mz7=false;var op3=false;var op4=false;var op5=false; var op=false; var ic=false;var tv=false;var old=false;var exclude=false;var lnx=false; var mac=false; var win=false; if (bType == "ie3") ie3 = true;if (bType == "ie4") ie4 = true; if (bType == "ie5") ie5 = true;if (bType == "ns3") ns3 = true;if (bType == "ns4") ns4 = true; if (bType == "ns6") ns6 = true;if (bType == "mz7") mz7 = true; if (bType == "op3") op3 = true;if (bType == "op4") op4 = true; if (bType == "op5") op5 = true;if (bType == "ic") { ic = true; }if (bType == "tv") tv = true; if (bType == "old") old = true;if (osType=="win") { win = true; }if (osType=="mac") { mac = true; }if (osType=="lnx") { lnx = true; }// create some browser groupsif (ie4 || ie5) { ie = true; }if (op3 || op4 || op5) { op = true; }if ((ie3==true) || (mac&&op) || (ns3==true) || op3 || op4 || ic || tv || old) { exclude = true; }// array building functions for custom.jsvar m=0;var sm=0;var cm=0;var mainItem = new Array;function addMainItem(ma,mb,mc,md,me) { sm=0;mainItem[m] = new Array(ma,mb,mc,md,me);if (mainItem[m][4]=="") { mainItem[m][4]="_self"; }m++;}var sp=0;var subProps = new Array;function defineSubmenuProperties(spa,spb,spc) {subProps[(m-1)] = new Array(spa,spb,spc);}var subItem = new Array;function addSubmenuItem(sma,smb,smc) {if (sm==0) { subItem[(m-1)] = new Array; }subItem[(m-1)][sm] = new Array(sma,smb,smc);if (subItem[(m-1)][sm][0]=="") { subItem[(m-1)][sm][0]="#"; }if (subItem[(m-1)][sm][1]=="") { subItem[(m-1)][sm][1]="&nbsp;"; }if (subItem[(m-1)][sm][2]=="") { subItem[(m-1)][sm][2]="_self"; }sm++;}